<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1237.5px" preserveAspectRatio="none" style="width:2518px;height:1237px;background:#FFFFFF;" version="1.1" viewBox="0 0 2518 1237" width="2518.5px" zoomAndPan="magnify"><defs><filter height="300%" id="fxjmbmxwi1y3c" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="3.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="6.0" dy="6.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="43.6719" style="stroke:#A80036;stroke-width:1.5;" width="15" x="373.5" y="124.9453"/><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="736.079" style="stroke:#A80036;stroke-width:1.5;" width="15" x="630" y="189.6172"/><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="174.6877" style="stroke:#A80036;stroke-width:1.5;" width="15" x="884.25" y="934.6963"/><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="328.2036" style="stroke:#A80036;stroke-width:1.5;" width="15" x="1122" y="305.6331"/><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="131.0158" style="stroke:#A80036;stroke-width:1.5;" width="15" x="1371" y="385.4769"/><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="106.8439" style="stroke:#A80036;stroke-width:1.5;" width="15" x="1803.75" y="677.5085"/><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="64.6719" style="stroke:#A80036;stroke-width:1.5;" width="15" x="2055.75" y="838.5244"/><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="703.079" style="stroke:#000000;stroke-width:3.0;" width="1887" x="490.5" y="212.1172"/><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="548.0632" style="stroke:#000000;stroke-width:3.0;" width="1490.25" x="505.5" y="248.2892"/><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="263.5316" style="stroke:#000000;stroke-width:3.0;" width="684" x="1014" y="328.1331"/><line style="stroke:#A80036;stroke-width:1.5;stroke-dasharray:5.0,5.0;" x1="124.5" x2="124.5" y1="100.9453" y2="1136.384"/><line style="stroke:#A80036;stroke-width:1.5;stroke-dasharray:5.0,5.0;" x1="381" x2="381" y1="100.9453" y2="1136.384"/><line style="stroke:#A80036;stroke-width:1.5;stroke-dasharray:5.0,5.0;" x1="637.5" x2="637.5" y1="100.9453" y2="1136.384"/><line style="stroke:#A80036;stroke-width:1.5;stroke-dasharray:5.0,5.0;" x1="891" x2="891" y1="100.9453" y2="1136.384"/><line style="stroke:#A80036;stroke-width:1.5;stroke-dasharray:5.0,5.0;" x1="1129.5" x2="1129.5" y1="100.9453" y2="1136.384"/><line style="stroke:#A80036;stroke-width:1.5;stroke-dasharray:5.0,5.0;" x1="1377.75" x2="1377.75" y1="100.9453" y2="1136.384"/><line style="stroke:#A80036;stroke-width:1.5;stroke-dasharray:5.0,5.0;" x1="1626" x2="1626" y1="100.9453" y2="1136.384"/><line style="stroke:#A80036;stroke-width:1.5;stroke-dasharray:5.0,5.0;" x1="1810.5" x2="1810.5" y1="100.9453" y2="1136.384"/><line style="stroke:#A80036;stroke-width:1.5;stroke-dasharray:5.0,5.0;" x1="2062.5" x2="2062.5" y1="100.9453" y2="1136.384"/><line style="stroke:#A80036;stroke-width:1.5;stroke-dasharray:5.0,5.0;" x1="2281.5" x2="2281.5" y1="100.9453" y2="1136.384"/><line style="stroke:#A80036;stroke-width:1.5;stroke-dasharray:5.0,5.0;" x1="2446.5" x2="2446.5" y1="100.9453" y2="1136.384"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="225" x="7.5" y="95.9927">importLinkPointsFlow</text><ellipse cx="124.5" cy="52.5" fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" rx="18" ry="18" style="stroke:#A80036;stroke-width:3.0;"/><polygon fill="#A80036" points="118.5,34.5,127.5,27,124.5,34.5,127.5,42,118.5,34.5" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="225" x="7.5" y="1154.3767">importLinkPointsFlow</text><ellipse cx="124.5" cy="1183.3293" fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" rx="18" ry="18" style="stroke:#A80036;stroke-width:3.0;"/><polygon fill="#A80036" points="118.5,1165.3293,127.5,1157.8293,124.5,1165.3293,127.5,1172.8293,118.5,1165.3293" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="240" x="256.5" y="95.9927">prepareLinkPointsStep</text><ellipse cx="381" cy="52.5" fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" rx="18" ry="18" style="stroke:#A80036;stroke-width:3.0;"/><polygon fill="#A80036" points="375,34.5,384,27,381,34.5,384,42,375,34.5" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="240" x="256.5" y="1154.3767">prepareLinkPointsStep</text><ellipse cx="381" cy="1183.3293" fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" rx="18" ry="18" style="stroke:#A80036;stroke-width:3.0;"/><polygon fill="#A80036" points="375,1165.3293,384,1157.8293,381,1165.3293,384,1172.8293,375,1165.3293" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="225" x="520.5" y="95.9927">importLinkPointsStep</text><ellipse cx="637.5" cy="52.5" fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" rx="18" ry="18" style="stroke:#A80036;stroke-width:3.0;"/><polygon fill="#A80036" points="631.5,34.5,640.5,27,637.5,34.5,640.5,42,631.5,34.5" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="225" x="520.5" y="1154.3767">importLinkPointsStep</text><ellipse cx="637.5" cy="1183.3293" fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" rx="18" ry="18" style="stroke:#A80036;stroke-width:3.0;"/><polygon fill="#A80036" points="631.5,1165.3293,640.5,1157.8293,637.5,1165.3293,640.5,1172.8293,631.5,1165.3293" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="235.5" x="769.5" y="95.9927">commitLinkPointsStep</text><ellipse cx="891.75" cy="52.5" fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" rx="18" ry="18" style="stroke:#A80036;stroke-width:3.0;"/><polygon fill="#A80036" points="885.75,34.5,894.75,27,891.75,34.5,894.75,42,885.75,34.5" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="235.5" x="769.5" y="1154.3767">commitLinkPointsStep</text><ellipse cx="891.75" cy="1183.3293" fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" rx="18" ry="18" style="stroke:#A80036;stroke-width:3.0;"/><polygon fill="#A80036" points="885.75,1165.3293,894.75,1157.8293,891.75,1165.3293,894.75,1172.8293,885.75,1165.3293" style="stroke:#A80036;stroke-width:1.5;"/><rect fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" height="45.4453" style="stroke:#A80036;stroke-width:2.25;" width="195" x="1029" y="48"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="174" x="1039.5" y="77.9927">LinkPointReader</text><rect fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" height="45.4453" style="stroke:#A80036;stroke-width:2.25;" width="195" x="1029" y="1134.884"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="174" x="1039.5" y="1164.8767">LinkPointReader</text><rect fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" height="45.4453" style="stroke:#A80036;stroke-width:2.25;" width="151.5" x="1299.75" y="48"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="130.5" x="1310.25" y="77.9927">PointReader</text><rect fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" height="45.4453" style="stroke:#A80036;stroke-width:2.25;" width="151.5" x="1299.75" y="1134.884"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="130.5" x="1310.25" y="1164.8767">PointReader</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="105" x="1569" y="95.9927">SourceDb</text><path d="M1599,22.5 C1599,7.5 1626,7.5 1626,7.5 C1626,7.5 1653,7.5 1653,22.5 L1653,61.5 C1653,76.5 1626,76.5 1626,76.5 C1626,76.5 1599,76.5 1599,61.5 L1599,22.5 " fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" style="stroke:#000000;stroke-width:2.25;"/><path d="M1599,22.5 C1599,37.5 1626,37.5 1626,37.5 C1626,37.5 1653,37.5 1653,22.5 " fill="none" style="stroke:#000000;stroke-width:2.25;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="105" x="1569" y="1154.3767">SourceDb</text><path d="M1599,1174.3293 C1599,1159.3293 1626,1159.3293 1626,1159.3293 C1626,1159.3293 1653,1159.3293 1653,1174.3293 L1653,1213.3293 C1653,1228.3293 1626,1228.3293 1626,1228.3293 C1626,1228.3293 1599,1228.3293 1599,1213.3293 L1599,1174.3293 " fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" style="stroke:#000000;stroke-width:2.25;"/><path d="M1599,1174.3293 C1599,1189.3293 1626,1189.3293 1626,1189.3293 C1626,1189.3293 1653,1189.3293 1653,1174.3293 " fill="none" style="stroke:#000000;stroke-width:2.25;"/><rect fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" height="45.4453" style="stroke:#A80036;stroke-width:2.25;" width="220.5" x="1698" y="48"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="199.5" x="1708.5" y="77.9927">LinkPointProcessor</text><rect fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" height="45.4453" style="stroke:#A80036;stroke-width:2.25;" width="220.5" x="1698" y="1134.884"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="199.5" x="1708.5" y="1164.8767">LinkPointProcessor</text><rect fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" height="45.4453" style="stroke:#A80036;stroke-width:2.25;" width="241.5" x="1939.5" y="48"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="220.5" x="1950" y="77.9927">GenericImportWriter</text><rect fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" height="45.4453" style="stroke:#A80036;stroke-width:2.25;" width="241.5" x="1939.5" y="1134.884"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="220.5" x="1950" y="1164.8767">GenericImportWriter</text><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="151.5" x="2202" y="95.9927">DestinationDb</text><path d="M2255.25,22.5 C2255.25,7.5 2282.25,7.5 2282.25,7.5 C2282.25,7.5 2309.25,7.5 2309.25,22.5 L2309.25,61.5 C2309.25,76.5 2282.25,76.5 2282.25,76.5 C2282.25,76.5 2255.25,76.5 2255.25,61.5 L2255.25,22.5 " fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" style="stroke:#000000;stroke-width:2.25;"/><path d="M2255.25,22.5 C2255.25,37.5 2282.25,37.5 2282.25,37.5 C2282.25,37.5 2309.25,37.5 2309.25,22.5 " fill="none" style="stroke:#000000;stroke-width:2.25;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="151.5" x="2202" y="1154.3767">DestinationDb</text><path d="M2255.25,1174.3293 C2255.25,1159.3293 2282.25,1159.3293 2282.25,1159.3293 C2282.25,1159.3293 2309.25,1159.3293 2309.25,1174.3293 L2309.25,1213.3293 C2309.25,1228.3293 2282.25,1228.3293 2282.25,1228.3293 C2282.25,1228.3293 2255.25,1228.3293 2255.25,1213.3293 L2255.25,1174.3293 " fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" style="stroke:#000000;stroke-width:2.25;"/><path d="M2255.25,1174.3293 C2255.25,1189.3293 2282.25,1189.3293 2282.25,1189.3293 C2282.25,1189.3293 2309.25,1189.3293 2309.25,1174.3293 " fill="none" style="stroke:#000000;stroke-width:2.25;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="130.5" x="2377.5" y="95.9927">TargetTable</text><path d="M2420.25,22.5 C2420.25,7.5 2447.25,7.5 2447.25,7.5 C2447.25,7.5 2474.25,7.5 2474.25,22.5 L2474.25,61.5 C2474.25,76.5 2447.25,76.5 2447.25,76.5 C2447.25,76.5 2420.25,76.5 2420.25,61.5 L2420.25,22.5 " fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" style="stroke:#000000;stroke-width:2.25;"/><path d="M2420.25,22.5 C2420.25,37.5 2447.25,37.5 2447.25,37.5 C2447.25,37.5 2474.25,37.5 2474.25,22.5 " fill="none" style="stroke:#000000;stroke-width:2.25;"/><text fill="#000000" font-family="sans-serif" font-size="21" lengthAdjust="spacing" textLength="130.5" x="2377.5" y="1154.3767">TargetTable</text><path d="M2420.25,1174.3293 C2420.25,1159.3293 2447.25,1159.3293 2447.25,1159.3293 C2447.25,1159.3293 2474.25,1159.3293 2474.25,1174.3293 L2474.25,1213.3293 C2474.25,1228.3293 2447.25,1228.3293 2447.25,1228.3293 C2447.25,1228.3293 2420.25,1228.3293 2420.25,1213.3293 L2420.25,1174.3293 " fill="#FEFECE" filter="url(#fxjmbmxwi1y3c)" style="stroke:#000000;stroke-width:2.25;"/><path d="M2420.25,1174.3293 C2420.25,1189.3293 2447.25,1189.3293 2447.25,1189.3293 C2447.25,1189.3293 2474.25,1189.3293 2474.25,1174.3293 " fill="none" style="stroke:#000000;stroke-width:2.25;"/><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="43.6719" style="stroke:#A80036;stroke-width:1.5;" width="15" x="373.5" y="124.9453"/><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="736.079" style="stroke:#A80036;stroke-width:1.5;" width="15" x="630" y="189.6172"/><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="174.6877" style="stroke:#A80036;stroke-width:1.5;" width="15" x="884.25" y="934.6963"/><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="328.2036" style="stroke:#A80036;stroke-width:1.5;" width="15" x="1122" y="305.6331"/><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="131.0158" style="stroke:#A80036;stroke-width:1.5;" width="15" x="1371" y="385.4769"/><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="106.8439" style="stroke:#A80036;stroke-width:1.5;" width="15" x="1803.75" y="677.5085"/><rect fill="#FFFFFF" filter="url(#fxjmbmxwi1y3c)" height="64.6719" style="stroke:#A80036;stroke-width:1.5;" width="15" x="2055.75" y="838.5244"/><polygon fill="#A80036" points="355.5,118.9453,370.5,124.9453,355.5,130.9453,361.5,124.9453" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="124.5" x2="364.5" y1="124.9453" y2="124.9453"/><polygon fill="#A80036" points="2264.25,162.6172,2279.25,168.6172,2264.25,174.6172,2270.25,168.6172" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="381" x2="2273.25" y1="168.6172" y2="168.6172"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-style="italic" lengthAdjust="spacing" textLength="81" x="391.5" y="161.0239">truncate</text><polygon fill="#A80036" points="612,183.6172,627,189.6172,612,195.6172,618,189.6172" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="124.5" x2="621" y1="189.6172" y2="189.6172"/><path d="M490.5,212.1172 L819,212.1172 L819,222.6172 L804,237.6172 L490.5,237.6172 L490.5,212.1172 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="703.079" style="stroke:#000000;stroke-width:3.0;" width="1887" x="490.5" y="212.1172"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-weight="bold" lengthAdjust="spacing" textLength="261" x="513" y="231.6958">Read all rows in chunks</text><path d="M505.5,248.2892 L1006.5,248.2892 L1006.5,258.7892 L991.5,273.7892 L505.5,273.7892 L505.5,248.2892 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="548.0632" style="stroke:#000000;stroke-width:3.0;" width="1490.25" x="505.5" y="248.2892"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-weight="bold" lengthAdjust="spacing" textLength="433.5" x="528" y="267.8678">Read and process chunk of N elements</text><polygon fill="#A80036" points="1104,299.6331,1119,305.6331,1104,311.6331,1110,305.6331" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="645" x2="1113" y1="305.6331" y2="305.6331"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-style="italic" lengthAdjust="spacing" textLength="58.5" x="655.5" y="298.0397">read()</text><path d="M1014,328.1331 L1530,328.1331 L1530,338.6331 L1515,353.6331 L1014,353.6331 L1014,328.1331 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="263.5316" style="stroke:#000000;stroke-width:3.0;" width="684" x="1014" y="328.1331"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-weight="bold" lengthAdjust="spacing" textLength="448.5" x="1036.5" y="347.7116">Repeat until all points for a link are read</text><polygon fill="#A80036" points="1353,379.4769,1368,385.4769,1353,391.4769,1359,385.4769" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1137" x2="1362" y1="385.4769" y2="385.4769"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-style="italic" lengthAdjust="spacing" textLength="58.5" x="1147.5" y="377.8836">read()</text><polygon fill="#A80036" points="1608,423.1489,1623,429.1489,1608,435.1489,1614,429.1489" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1386" x2="1617" y1="429.1489" y2="429.1489"/><text fill="#000000" font-family="monospace" font-size="19.5" lengthAdjust="spacing" textLength="204" x="1396.5" y="421.5555">import_points.sql</text><polygon fill="#A80036" points="1402.5,466.8208,1387.5,472.8208,1402.5,478.8208,1396.5,472.8208" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1393.5" x2="1624.5" y1="472.8208" y2="472.8208"/><text fill="#000000" font-family="monospace" font-size="19.5" lengthAdjust="spacing" textLength="108" x="1411.5" y="465.2275">ResultSet</text><polygon fill="#A80036" points="1153.5,510.4927,1138.5,516.4927,1153.5,522.4927,1147.5,516.4927" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;stroke-dasharray:2.0,2.0;" x1="1144.5" x2="1377" y1="516.4927" y2="516.4927"/><text fill="#000000" font-family="monospace" font-size="19.5" lengthAdjust="spacing" textLength="96" x="1162.5" y="508.8994">PointRow</text><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="6" x="1264.5" y="508.8994">|</text><text fill="#000000" font-family="monospace" font-size="19.5" lengthAdjust="spacing" textLength="48" x="1276.5" y="508.8994">null</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1137" x2="1200" y1="560.1647" y2="560.1647"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1200" x2="1200" y1="560.1647" y2="579.6647"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1138.5" x2="1200" y1="579.6647" y2="579.6647"/><polygon fill="#A80036" points="1153.5,573.6647,1138.5,579.6647,1153.5,585.6647,1147.5,579.6647" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="75" x="1147.5" y="552.5713">store to</text><text fill="#000000" font-family="monospace" font-size="19.5" lengthAdjust="spacing" textLength="132" x="1228.5" y="552.5713">ReaderState</text><polygon fill="#A80036" points="661.5,627.8366,646.5,633.8366,661.5,639.8366,655.5,633.8366" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="652.5" x2="1128" y1="633.8366" y2="633.8366"/><text fill="#000000" font-family="monospace" font-size="19.5" lengthAdjust="spacing" textLength="120" x="670.5" y="626.2433">LinkPoints</text><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="66" x="796.5" y="626.2433">| "null"</text><polygon fill="#A80036" points="1785.75,671.5085,1800.75,677.5085,1785.75,683.5085,1791.75,677.5085" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="645" x2="1794.75" y1="677.5085" y2="677.5085"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-style="italic" lengthAdjust="spacing" textLength="82.5" x="655.5" y="669.9152">process(</text><text fill="#000000" font-family="monospace" font-size="19.5" lengthAdjust="spacing" textLength="120" x="738" y="669.9152">LinkPoints</text><text fill="#000000" font-family="sans-serif" font-size="19.5" font-style="italic" lengthAdjust="spacing" textLength="7.5" x="858" y="669.9152">)</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1818.75" x2="1881.75" y1="721.1805" y2="721.1805"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1881.75" x2="1881.75" y1="721.1805" y2="740.6805"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1820.25" x2="1881.75" y1="740.6805" y2="740.6805"/><polygon fill="#A80036" points="1835.25,734.6805,1820.25,740.6805,1835.25,746.6805,1829.25,740.6805" style="stroke:#A80036;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="148.5" x="1829.25" y="713.5871">build geometry</text><polygon fill="#A80036" points="661.5,778.3524,646.5,784.3524,661.5,790.3524,655.5,784.3524" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;stroke-dasharray:2.0,2.0;" x1="652.5" x2="1809.75" y1="784.3524" y2="784.3524"/><text fill="#000000" font-family="monospace" font-size="19.5" lengthAdjust="spacing" textLength="144" x="670.5" y="776.7591">LinkGeometry</text><polygon fill="#A80036" points="2037.75,832.5244,2052.75,838.5244,2037.75,844.5244,2043.75,838.5244" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="645" x2="2046.75" y1="838.5244" y2="838.5244"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-style="italic" lengthAdjust="spacing" textLength="57" x="655.5" y="830.931">write(</text><text fill="#000000" font-family="monospace" font-size="19.5" lengthAdjust="spacing" textLength="228" x="712.5" y="830.931">Chunk&lt;LinkGeometry&gt;</text><text fill="#000000" font-family="sans-serif" font-size="19.5" font-style="italic" lengthAdjust="spacing" textLength="7.5" x="940.5" y="830.931">)</text><polygon fill="#A80036" points="2264.25,876.1963,2279.25,882.1963,2264.25,888.1963,2270.25,882.1963" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="2070.75" x2="2273.25" y1="882.1963" y2="882.1963"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="169.5" x="2081.25" y="874.6029">JDBC batch insert</text><polygon fill="#A80036" points="661.5,897.1963,646.5,903.1963,661.5,909.1963,655.5,903.1963" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;stroke-dasharray:2.0,2.0;" x1="652.5" x2="2061.75" y1="903.1963" y2="903.1963"/><polygon fill="#A80036" points="866.25,928.6963,881.25,934.6963,866.25,940.6963,872.25,934.6963" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="124.5" x2="875.25" y1="934.6963" y2="934.6963"/><polygon fill="#A80036" points="2264.25,972.3682,2279.25,978.3682,2264.25,984.3682,2270.25,978.3682" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="899.25" x2="2273.25" y1="978.3682" y2="978.3682"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-style="italic" lengthAdjust="spacing" textLength="75" x="909.75" y="970.7749">commit</text><polygon fill="#A80036" points="2429.25,1016.0402,2444.25,1022.0402,2429.25,1028.0402,2435.25,1022.0402" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="2282.25" x2="2438.25" y1="1022.0402" y2="1022.0402"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-style="italic" lengthAdjust="spacing" textLength="67.5" x="2292.75" y="1014.4468">update</text><polygon fill="#A80036" points="915.75,1059.7121,900.75,1065.7121,915.75,1071.7121,909.75,1065.7121" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="906.75" x2="2445.75" y1="1065.7121" y2="1065.7121"/><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="79.5" x="924.75" y="1058.1187">updated</text><text fill="#000000" font-family="monospace" font-size="19.5" lengthAdjust="spacing" textLength="72" x="1010.25" y="1058.1187">LinkPK</text><text fill="#000000" font-family="sans-serif" font-size="19.5" lengthAdjust="spacing" textLength="10.5" x="1082.25" y="1058.1187">s</text><polygon fill="#A80036" points="2264.25,1103.384,2279.25,1109.384,2264.25,1115.384,2270.25,1109.384" style="stroke:#A80036;stroke-width:1.5;"/><line style="stroke:#A80036;stroke-width:1.5;" x1="891.75" x2="2273.25" y1="1109.384" y2="1109.384"/><text fill="#000000" font-family="sans-serif" font-size="19.5" font-style="italic" lengthAdjust="spacing" textLength="81" x="902.25" y="1101.7907">truncate</text><!--MD5=[d0f7af509dcf3844f5620c879ded47a5]
@startuml

control importLinkPointsFlow as flow
control prepareLinkPointsStep as prepare_step
control importLinkPointsStep as import_step
control commitLinkPointsStep as commit_step
participant LinkPointReader as linkpoint_reader
participant PointReader as point_reader
database SourceDb as sdb
participant LinkPointProcessor as processor
participant GenericImportWriter as writer
database DestinationDb as staging_table
database TargetTable as target_table

flow -> prepare_step
activate prepare_step

prepare_step -> staging_table : //truncate//
deactivate prepare_step

flow -> import_step
activate import_step

group Read all rows in chunks

    group Read and process chunk of N elements

        import_step -> linkpoint_reader : //read()//
        activate linkpoint_reader

        group Repeat until all points for a link are read
            linkpoint_reader -> point_reader : //read()//

            activate point_reader

            point_reader -> sdb : ""import_points.sql""
            point_reader <- sdb : ""ResultSet""

            linkpoint_reader <- - point_reader : ""PointRow"" | ""null""
            deactivate point_reader

            linkpoint_reader -> linkpoint_reader : store to ""ReaderState""
        end

        import_step <- linkpoint_reader :""LinkPoints"" | "null"
        deactivate linkpoint_reader

        import_step -> processor : //process(//""LinkPoints""//)//
        activate processor
        processor -> processor : build geometry
        import_step <- - processor : ""LinkGeometry""
        deactivate processor

    end

    import_step -> writer : //write(//""Chunk<LinkGeometry>""//)//
    activate writer
    writer -> staging_table : JDBC batch insert
    import_step <- - writer
    deactivate writer

end

deactivate import_step

flow -> commit_step
activate commit_step

commit_step -> staging_table : //commit//
staging_table -> target_table : //update//
commit_step <- target_table : updated ""LinkPK""s

commit_step -> staging_table : //truncate//
deactivate commit_step


@enduml

PlantUML version 1.2021.7(Sun May 23 15:40:07 EEST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: Dynamic Code Evolution 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>